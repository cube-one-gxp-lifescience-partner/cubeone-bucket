{
    "version": "1.0.0",
    "description": "FortiClient VPN - SSL VPN client for secure remote access",
    "homepage": "https://github.com/cube-one-gxp-lifescience-partner/cubeone-bucket",
    "license": "Proprietary",
    "url": "https://github.com/cube-one-gxp-lifescience-partner/cubeone-bucket/releases/download/1.0.0/FortiClientVPN.msi",
    "installer": {
        "args": [
            "/passive",
            "/norestart"
        ]
    },
    "post_install": [
        "Write-Host 'FortiClient VPN installed from cube-one repository!' -ForegroundColor Green",
        "Write-Host 'Setting up basic registry configuration...' -ForegroundColor Yellow",
        "New-Item -Path 'HKLM:\\SOFTWARE\\Fortinet\\FortiClient\\Sslvpn\\Tunnels' -Force -ErrorAction SilentlyContinue",
        "Write-Host 'FortiClient VPN ready to use!' -ForegroundColor Green"
    ],
    "uninstaller": {
        "script": [
            "Write-Host 'Uninstalling FortiClient VPN...' -ForegroundColor Yellow",
            "Get-Process -Name 'FortiClient*' -ErrorAction SilentlyContinue | Stop-Process -Force -ErrorAction SilentlyContinue",
            "Start-Sleep -Seconds 2",
            "$uninstallKeys = @(",
            "    'HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*',",
            "    'HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*'",
            ")",
            "foreach ($key in $uninstallKeys) {",
            "    Get-ItemProperty -Path $key -ErrorAction SilentlyContinue | Where-Object { $_.DisplayName -like '*FortiClient*' } | ForEach-Object {",
            "        if ($_.UninstallString -like '*msiexec*') {",
            "            Write-Host \"Uninstalling: $($_.DisplayName)\" -ForegroundColor Cyan",
            "            $productCode = $_.PSChildName",
            "            Start-Process -FilePath 'msiexec' -ArgumentList '/x', $productCode, '/quiet', '/norestart', 'REBOOT=ReallySuppress' -Wait -NoNewWindow",
            "        }",
            "    }",
            "}",
            "Remove-Item -Path 'HKLM:\\SOFTWARE\\Fortinet' -Recurse -Force -ErrorAction SilentlyContinue",
            "Write-Host 'FortiClient VPN uninstalled!' -ForegroundColor Green"
        ]
    },
    "bin": "FortiClient.exe",
    "shortcuts": [
        [
            "FortiClient.exe",
            "FortiClient VPN"
        ]
    ],
    "checkver": {
        "github": "https://github.com/cube-one-gxp-lifescience-partner/cubeone-bucket",
        "use_latest_release": false
    },
    "autoupdate": {
        "url": "https://github.com/cube-one-gxp-lifescience-partner/cubeone-bucket/releases/download/$version/FortiClientVPN.msi"
    }
}
