{
    "version": "7.4.3",
    "description": "FortiClient VPN - SSL VPN client for secure remote access",
    "homepage": "https://www.fortinet.com/products/endpoint-security/forticlient",
    "license": "Proprietary",
    "url": "https://filestore.fortinet.com/forticlient/downloads/FortiClientVPNInstaller.exe",
    "installer": {
        "args": [
            "/quiet",
            "/norestart"
        ],
        "keep": true
    },
    "post_install": [
        "Write-Host 'FortiClient VPN installed successfully!' -ForegroundColor Green"
    ],
    "uninstaller": {
        "script": [
            "Write-Host 'Uninstalling FortiClient VPN...' -ForegroundColor Yellow",
            "# Versuche Ã¼ber Programme und Features zu deinstallieren",
            "$uninstallKeys = @(",
            "    'HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*',",
            "    'HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*'",
            ")",
            "foreach ($key in $uninstallKeys) {",
            "    Get-ItemProperty -Path $key -ErrorAction SilentlyContinue | Where-Object { $_.DisplayName -like '*FortiClient*' } | ForEach-Object {",
            "        if ($_.UninstallString) {",
            "            Write-Host \"Found FortiClient: $($_.DisplayName)\" -ForegroundColor Cyan",
            "            if ($_.UninstallString -like '*msiexec*') {",
            "                # MSI-Deinstallation",
            "                $productCode = $_.PSChildName",
            "                Start-Process -FilePath 'msiexec' -ArgumentList '/x', $productCode, '/quiet', '/norestart' -Wait -NoNewWindow",
            "            } else {",
            "                # EXE-Deinstallation",
            "                $uninstallCmd = $_.UninstallString",
            "                if ($uninstallCmd -notlike '*quiet*') {",
            "                    $uninstallCmd += ' /quiet'",
            "                }",
            "                if ($uninstallCmd -notlike '*norestart*') {",
            "                    $uninstallCmd += ' /norestart'",
            "                }",
            "                Start-Process -FilePath 'cmd' -ArgumentList '/c', $uninstallCmd -Wait -NoNewWindow",
            "            }",
            "        }",
            "    }",
            "}",
            "Write-Host 'FortiClient VPN uninstalled!' -ForegroundColor Green"
        ]
    },
    "bin": [
        "FortiClientVPNInstaller.exe"
    ],
    "checkver": {
        "script": [
            "$url = 'https://filestore.fortinet.com/forticlient/downloads/FortiClientVPNInstaller.exe'",
            "$tempFile = New-TemporaryFile",
            "try {",
            "    Invoke-WebRequest -Uri $url -OutFile $tempFile -UseBasicParsing",
            "    $versionInfo = (Get-ItemProperty $tempFile).VersionInfo",
            "    $version = $versionInfo.ProductVersion",
            "    if (!$version -or $version -eq '0.0.0.0') {",
            "        $version = $versionInfo.FileVersion",
            "    }",
            "    if (!$version -or $version -eq '0.0.0.0') {",
            "        $hash = (Get-FileHash $tempFile -Algorithm SHA256).Hash",
            "        $version = $hash.Substring(0,8)",
            "    }",
            "    Write-Output $version",
            "} catch {",
            "    Write-Output (Get-Date -Format 'yyyy.MM.dd.HHmm')",
            "} finally {",
            "    Remove-Item $tempFile -ErrorAction SilentlyContinue",
            "}"
        ]
    },
    "autoupdate": {
        "url": "https://filestore.fortinet.com/forticlient/downloads/FortiClientVPNInstaller_$version.exe"
    }
}
