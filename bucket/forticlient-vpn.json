{
    "version": "1.0.0",
    "description": "FortiClient VPN - SSL VPN client for secure remote access",
    "homepage": "https://github.com/cube-one-gxp-lifescience-partner/cubeone-bucket",
    "license": "Proprietary",
    "url": "https://github.com/cube-one-gxp-lifescience-partner/cubeone-bucket/releases/download/1.0.0/FortiClientVPN.msi",
    "pre_install": [
        "Write-Host 'Downloading FortiClient VPN MSI...' -ForegroundColor Green"
    ],
    "installer": {
        "script": [
            "Write-Host 'Installing FortiClient VPN with /passive /norestart...' -ForegroundColor Green",
            "$msiPath = \"$dir\\FortiClientVPN.msi\"",
            "if (-not (Test-Path $msiPath)) {",
            "    Write-Host \"MSI file not found at: $msiPath\" -ForegroundColor Red",
            "    Get-ChildItem $dir | ForEach-Object { Write-Host \"Found: $($_.Name)\" }",
            "    exit 1",
            "}",
            "Write-Host \"Executing: msiexec /i `\"$msiPath`\" /passive /norestart\" -ForegroundColor Cyan",
            "$process = Start-Process -FilePath 'msiexec' -ArgumentList '/i', \"`\"$msiPath`\"\", '/passive', '/norestart' -Wait -PassThru -NoNewWindow",
            "if ($process.ExitCode -eq 0) {",
            "    Write-Host 'FortiClient VPN installed successfully!' -ForegroundColor Green",
            "} else {",
            "    Write-Host \"Installation failed with exit code: $($process.ExitCode)\" -ForegroundColor Red",
            "    exit $process.ExitCode",
            "}"
        ]
    },
    "post_install": [
        "Write-Host 'Cleaning up installation files...' -ForegroundColor Yellow",
        "Remove-Item -Path \"$dir\\FortiClientVPN.msi\" -Force -ErrorAction SilentlyContinue",
        "Write-Host 'FortiClient VPN installation completed with /passive /norestart!' -ForegroundColor Green"
    ],
    "uninstaller": {
        "script": [
            "Write-Host 'Uninstalling FortiClient VPN...' -ForegroundColor Yellow",
            "Get-Process -Name 'FortiClient*' -ErrorAction SilentlyContinue | Stop-Process -Force -ErrorAction SilentlyContinue",
            "Start-Sleep -Seconds 2",
            "$uninstallKeys = @(",
            "    'HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*',",
            "    'HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*'",
            ")",
            "$found = $false",
            "foreach ($key in $uninstallKeys) {",
            "    Get-ItemProperty -Path $key -ErrorAction SilentlyContinue | Where-Object { $_.DisplayName -like '*FortiClient*' } | ForEach-Object {",
            "        $found = $true",
            "        Write-Host \"Uninstalling: $($_.DisplayName)\" -ForegroundColor Cyan",
            "        $productCode = $_.PSChildName",
            "        $process = Start-Process -FilePath 'msiexec' -ArgumentList '/x', $productCode, '/passive', '/norestart' -Wait -PassThru -NoNewWindow",
            "        if ($process.ExitCode -eq 0) {",
            "            Write-Host \"Successfully uninstalled: $($_.DisplayName)\" -ForegroundColor Green",
            "        } else {",
            "            Write-Host \"Uninstall failed with exit code: $($process.ExitCode)\" -ForegroundColor Red",
            "        }",
            "    }",
            "}",
            "if (-not $found) {",
            "    Write-Host 'No FortiClient installation found in registry' -ForegroundColor Yellow",
            "}",
            "Write-Host 'FortiClient VPN uninstall completed!' -ForegroundColor Green"
        ]
    },
    "checkver": {
        "url": "https://api.github.com/repos/cube-one-gxp-lifescience-partner/cubeone-bucket/releases",
        "jsonpath": "$[0].tag_name",
        "regex": "^v?([\\d.]+(?:-[\\w.]+)?)$"
    },
    "autoupdate": {
        "url": "https://github.com/cube-one-gxp-lifescience-partner/cubeone-bucket/releases/download/$version/FortiClientVPN.msi"
    }
}
